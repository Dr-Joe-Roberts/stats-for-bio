data.frame(xloc  = runif(nsamp),
yloc  = runif(nsamp),
morph = sample(c("purple","green")[index], 100, replace = TRUE))
plttheme <- theme_get()
sample1 <- sample_n(plantdata, size = sampsize1)
.4 * 80
load(file = "./object_cache/plant_morphs.rda")
load(file = "./_rda_objects/plant_morphs.rda")
sample2 <- sample_n(plantdata, size = sampsize1)
baseplt + geom_point(data = sample2, colour = "red", shape = 1, size = 5)
freqs2 <- table(sample2$morph)
library(dplyr)
library(ggplot2)
sample2 <- sample_n(plantdata, size = sampsize1)
baseplt + geom_point(data = sample2, colour = "red", shape = 1, size = 5)
freqs2 <- table(sample2$morph)
out <- data.frame(n.purple = factor(rbinom(n = 100000, size = sampsize1, prob = prop.purp)))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(limits = as.character(0:sampsize1)) +
xlab("No. of purple morph individuals (n = 20)") + ylab("Count")
?scale_x_discrete
as.character(0:sampsize1)
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(limits = as.character(0:sampsize1)) +
xlab("No. of purple morph individuals (n = 20)") + ylab("Count")
out <- data.frame(n.purple = factor(rbinom(n = 100000, size = sampsize1, prob = prop.purp)))
levs <- as.character(0:sampsize1)
ggplot(out, aes(x = factor(n.purple, levs)) + geom_bar() +
scale_x_discrete(limits = levs) +
xlab("No. of purple morph individuals (n = 20)") + ylab("Count")
out <- data.frame(n.purple = factor(rbinom(n = 100000, size = sampsize1, prob = prop.purp)))
levs <- as.character(0:sampsize1)
ggplot(out, aes(x = factor(n.purple, levs))) + geom_bar() +
scale_x_discrete(limits = levs) +
xlab("No. of purple morph individuals (n = 20)") + ylab("Count")
levels(out$n.purple)
sampsize1
factor(out$n.purple)
factor(out$n.purple, levels = levs)
out <- data.frame(n.purple = factor(rbinom(n = 100000, size = sampsize1, prob = prop.purp)))
levs <- as.character(0:sampsize1)
ggplot(out, aes(x = factor(n.purple, levels = levs))) + geom_bar() +
scale_x_discrete(limits = levs) +
xlab("No. of purple morph individuals (n = 20)") + ylab("Count")
ggplot(out, aes(x = factor(n.purple, levels = levs))) + geom_bar()
scale_x_discrete()
scale_x_discretea?
?scale_x_discrete
levs
levs
out <- data.frame(n.purple = factor(rbinom(n = 100000, size = sampsize1, prob = prop.purp)))
levs <- as.character(0:sampsize1)
ggplot(out, aes(x = factor(n.purple, levels = levs))) + geom_bar() +
scale_x_discrete(limits = levs) +
xlab("No. of purple morph individuals (n = 20)") + ylab("Count")
?stat_bin
out
x <- rbinom(n = 100000, size = sampsize1, prob = prop.purp)
out <- data.frame(n.purple = factor(x, levels = as.character(0:sampsize1)))
limits <- as.character(0:sampsize1)
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(limits = limits) +
xlab("No. of purple morph individuals (n = 20)") + ylab("Count")
out
levels(out$n.purple)
x <- rbinom(n = 100000, size = sampsize1, prob = prop.purp)
out <- data.frame(n.purple = factor(x, levels = as.character(0:sampsize1)))
limits <- as.character(0:sampsize1)
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(limits = limits, drop = FALSE) +
xlab("No. of purple morph individuals (n = 20)") + ylab("Count")
x <- rbinom(n = 100000, size = sampsize2, prob = prop.purp)
out <- data.frame(n.purple = factor(x, levels = as.character(0:sampsize2)))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(limits = as.character(seq(0, sampsize2, 1)),
breaks = as.character(seq(0, sampsize2, 2)),
drop = FALSE) +
xlab("No. of purple morph individuals") + ylab("Count")
x <- rbinom(n = 100000, size = sampsize3, prob = prop.purp)
out <- data.frame(n.purple = factor(x, levels = as.character(0:sampsize3)))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(limits = as.character(seq(0, sampsize3, 1)),
breaks = as.character(seq(0, sampsize3, 4)),
drop = FALSE) +
xlab("No. of purple morph individuals") + ylab("Count")
geom_vline()
15/20
sampsizebig <- 500
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
round(x, 2)
round(x, -2)
round(x, -1)
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
x <- round(x, -1)
out <- data.frame(n.purple = factor(x))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(limits = as.character(seq(0, sampsizebig, 10)),
breaks = as.character(seq(0, sampsizebig, 20))) +
xlab("No. of purple morph individuals") + ylab("Count")
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
x <- round(x, -1)
out <- data.frame(n.purple = factor(x, as.character(seq(0, sampsizebig, 10))))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(breaks = as.character(seq(0, sampsizebig, 20))) +
xlab("No. of purple morph individuals") + ylab("Count")
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
x <- round(x, -1)
out <- data.frame(n.purple = factor(x, as.character(seq(0, sampsizebig, 1))))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(breaks = as.character(seq(0, sampsizebig, 20))) +
xlab("No. of purple morph individuals") + ylab("Count")
x <- round(x, -0.5)
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
x <- round(x, -0.5)
x
?round
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
x <- round(5*x, -1)/5
x
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
x <- round(5*x, -1)/5
out <- data.frame(n.purple = factor(x, as.character(seq(0, sampsizebig, 2))))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(breaks = as.character(seq(0, sampsizebig, 20))) +
xlab("No. of purple morph individuals") + ylab("Count")
x <- round(2*x, -1)/2
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
x <- round(2*x, -1)/2
out <- data.frame(n.purple = factor(x, as.character(seq(0, sampsizebig, 2))))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(breaks = as.character(seq(0, sampsizebig, 20))) +
xlab("No. of purple morph individuals") + ylab("Count")
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
out <- data.frame(n.purple = factor(x, as.character(seq(0, sampsizebig, 2))))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(breaks = as.character(seq(0, sampsizebig, 20))) +
xlab("No. of purple morph individuals") + ylab("Count")
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
out <- data.frame(n.purple = factor(x, as.character(seq(0, sampsizebig, 2))))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete() +
xlab("No. of purple morph individuals") + ylab("Count")
out <- data.frame(n.purple = factor(x, as.character(0:sampsizebig)))
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
out <- data.frame(n.purple = factor(x, as.character(0:sampsizebig)))
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete() +
xlab("No. of purple morph individuals") + ylab("Count")
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
ggplot(out, aes(x = n.purple)) + geom_bar() +
scale_x_discrete(drop = FALSE) +
xlab("No. of purple morph individuals") + ylab("Count")
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
out <- data.frame(n.purple = x)
ggplot(out, aes(x = n.purple)) + geom_histogram() +
xlab("No. of purple morph individuals") + ylab("Count")
x <- rbinom(n = 100000, size = sampsizebig, prob = prop.purp)
out <- data.frame(n.purple = x)
ggplot(out, aes(x = n.purple)) + geom_histogram(binwidth = 2) +
xlab("No. of purple morph individuals") + ylab("Count")
ggplot(out, aes(x = n.purple)) +
geom_histogram(binwidth = 2) + xlim(0, sampsizebig) +
xlab("No. of purple morph individuals") + ylab("Count")
purple_prob <- 0.4
sample_size <- 100
n_samples <- 100000
raw_samples <- rbinom(n = n_samples, size = sample_size, prob = purple_prob)
percent_samples <- 100 * raw_samples / sample_size
head(percent_samples, 50)
sd(percent_samples)
samp-dist-2
sampsize3
purple_prob <- 0.4
sample_size <- 80
n_samples <- 100000
raw_samples <- rbinom(n = n_samples, size = sample_size, prob = purple_prob)
percent_samples <- 100 * raw_samples / sample_size
head(percent_samples, 50)
sd(percent_samples)
sample(c("Purple","Green"), replace = TRUE)
sample(c("Purple","Green"), 4, replace = TRUE)
?sample
sample(c("Purple","Green"), 4, replace = TRUE, prob = c(4,6))
n_samp <- 100
sample(c("Purple","Green"), n_samp, replace = TRUE, prob = c(4,6))
n_samp <- 100
plant_morphs <- sample(c("Purple","Green"), n_samp, replace = TRUE, prob = c(4,6))
set.seed(27081975)
n_samp <- 100
plant_morphs <- sample(c("Purple","Green"), n_samp, replace = TRUE, prob = c(4,6))
replicate(10000,
mean(sample(plant_morphs, replace = TRUE)))
replicate(10000,
table(sample(plant_morphs, replace = TRUE)))
out <- replicate(10000, table(sample(plant_morphs, replace = TRUE)))
out[1,]
out[,1]
set.seed(27081975)
n_samp <- 250
plant_morphs <- sample(c("Purple","Green"), n_samp, replace = TRUE, prob = c(4,6))
out <- replicate(10000, table(sample(plant_morphs, replace = TRUE)))
out <- replicate(10000, table(sample(plant_morphs, replace = TRUE))[1]/n_samp)
out
table(plant_morphs)[1]/n_samp
table(plant_morphs) / n_samp
table(plant_morphs)[2] / n_samp
out <- replicate(10000, table(sample(plant_morphs, replace = TRUE))[2]/n_samp)
out <- replicate(10000,
plant_morphs %>% sample(replace = TRUE)
out <- replicate(10000,
plant_morphs %>% sample(replace = TRUE)
plant_morphs %>% sample(replace = TRUE)
out <- replicate(10000,
plant_morphs %>% sample(replace = TRUE) == "Purple"
plant_morphs %>% sample(replace = TRUE) == "Purple"
out <- replicate(10000,
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
out <- replicate(10000,
sum(plant_morphs %>% sample(replace = TRUE) == "Purple")
)
out
out <- replicate(10000,
plant_morphs %>% sample(replace = TRUE) == "Purple" %>% sum
out <- replicate(10000,
plant_morphs %>% sample(replace = TRUE) == "Purple" %>% sum)
out <- replicate(10000,
plant_morphs %>% (sample(replace = TRUE) == "Purple") %>% sum)
out <- replicate(10000,
sum(sample(plant_morphs, replace = TRUE) == "Purple"))
out
out <- replicate(10000,
sum(sample(plant_morphs, replace = TRUE) == "Purple"))
out <- replicate(10000,
(sample(plant_morphs, replace = TRUE) == "Purple") %>% sum)
out
out <- replicate(10000,
plant_morphs %>% (sample(., replace = TRUE) == "Purple") %>% sum)
out <- replicate(10000,
plant_morphs %>%
sample(replace = TRUE) %>%
`==`("Purple") %>% sum)
out
sample(plant_morphs, replace = TRUE)
sample(plant_morphs, replace = TRUE) == "Purple"
sum(sample(plant_morphs, replace = TRUE) == "Purple")
sum(sample(plant_morphs, replace = TRUE) == "Purple")
out <- replicate(10000, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / n_samp
})
out
hist(out)
out<0.25
sum(out<0.25)
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
n_samp <- 10000
out <- replicate(n_samp, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / samp_size
})
hist(out)
sum(out < 0.25)
sum(out < 0.25) / n_samp
?sample_n
data.frame(plant_morphs)
data.frame(plant_morphs) %>%
sample_n(size = samp_size)
data.frame(plant_morphs) %>%
sample_n(size = samp_size)
data.frame(plant_morphs) %>%
sample_n(size = samp_size, replace = TRUE)
data.frame(plant_morphs) %>%
sample_n(size = samp_size, replace = TRUE)
data.frame(plant_morphs) %>%
sample_n(size = samp_size, replace = TRUE)
data.frame(plant_morphs) %>%
sample_n(size = samp_size, replace = TRUE)
sample_n(data.frame(plant_morphs), size = samp_size, replace = TRUE)
replicate(2,
sample_n(data.frame(plant_morphs), size = samp_size, replace = TRUE))
sum(out < 0.25) / n_samp
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
n_samp <- 10000
out <- replicate(n_samp, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / samp_size
})
hist(out)
sum(out < 0.25) / n_samp
plant_morphs
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
set.seed(27081975)
samp_size <- 200
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
means <- c(Purple = 740, Green = 720)[plant_morphs]
nsample <- 25
n_samp <- 10000
out <- replicate(n_samp, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / samp_size
})
hist(out)
sum(out < 0.25) / n_samp
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
means <- c(Purple = 740, Green = 720)[plant_morphs]
nsample <- 25
prpszs <- rnorm(nsample, mean = 700, sd = 150) + 20
grnszs <- rnorm(nsample, mean = 740, sd = 160)
pmorph <- c("purple","green")[rep(1:2, each = nsample)]
n_samp <- 10000
out <- replicate(n_samp, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / samp_size
})
hist(out)
sum(out < 0.25) / n_samp
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
means <- c(Purple = 740, Green = 720)[plant_morphs]
nsample <- 25
prpszs <- rnorm(nsample, mean = 700, sd = 150) + 20
grnszs <- rnorm(nsample, mean = 740, sd = 160)
pmorph <- c("purple","green")[rep(1:2, each = nsample)]
n_samp <- 10000
out <- replicate(n_samp, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / samp_size
})
hist(out)
sum(out < 0.25) / n_samp
means
rnorm(samp_size, mns, sds)
mns <- c(Purple = 740, Green = 720)[plant_morphs]
sds <- c(Purple = 160, Green = 150)[plant_morphs]
rnorm(samp_size, mns, sds)
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
mns <- c(Purple = 740, Green = 720)[plant_morphs]
sds <- c(Purple = 160, Green = 150)[plant_morphs]
morph.data <- data.frame(Colour = plant_morphs,
Weight = rnorm(samp_size, mns, sds))
morph.data
t.test(Weight ~ Colour, data = morph.data)
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
mns <- c(Purple = 740, Green = 700)[plant_morphs]
sds <- c(Purple = 160, Green = 150)[plant_morphs]
morph.data <- data.frame(Colour = plant_morphs,
Weight = rnorm(samp_size, mns, sds))
t.test(Weight ~ Colour, data = morph.data)
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
mns <- c(Purple = 750, Green = 700)[plant_morphs]
sds <- c(Purple = 160, Green = 150)[plant_morphs]
morph.data <- data.frame(Colour = plant_morphs,
Weight = rnorm(samp_size, mns, sds))
t.test(Weight ~ Colour, data = morph.data)
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"), samp_size, replace = TRUE, prob = c(4,6))
mns <- c(Purple = 760, Green = 700)[plant_morphs]
sds <- c(Purple = 160, Green = 150)[plant_morphs]
morph.data <- data.frame(Colour = plant_morphs,
Weight = rnorm(samp_size, mns, sds))
t.test(Weight ~ Colour, data = morph.data)
plant_morphs <- morph.data$Colour
plant_morphs <- morph.data$Colour
samp_size <- length(plant_morph)
samp_size <- length(plant_morphs)
samp_size
plant_morphs <- morph.data$Colour
samp_size <- length(plant_morphs)
n_samp <- 10000
out <- replicate(n_samp, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / samp_size
})
hist(out)
sum(out < 0.25) / n_samp
plant_morphs <- morph.data$Colour
samp_size <- length(plant_morphs)
n_samp <- 100000
out <- replicate(n_samp, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / samp_size
})
hist(out)
sum(out < 0.25) / n_samp
plant_morphs <- morph.data$Colour
samp_size <- length(plant_morphs)
n_samp <- 10000
out <- replicate(n_samp, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / samp_size
})
hist(out)
sum(out < 0.25) / n_samp
t.test(Weight ~ Colour, data = morph.data)
nrow(morph.data)
plant_morphs <- morph.data$Colour
(plant_morphs)
head(plant_morphs, 20)
samp <- sample(plant_morphs, replace = TRUE)
head(samp, 20)
sum(samp == "Purple") / samp_size
boot_out <- replicate(n_samp, {
samp <- sample(plant_morphs, replace = TRUE)
sum(samp == "Purple") / samp_size
})
library(dplyr)
tbl_df(Orange)
tbl_df(Orange)
tbl_df(Orange)
as_data_frame(Orange)
?tbl_df
storms <- read.csv("../data_csv/STORMS.CSV")
storms
rm(morph.data)
rm(plantdata)
rm(sample2)
str(storms)
storms <- read.csv("storms.csv")
storms <- read.csv("../data_csv/STORMS.CSV")
storms$name
install.packages("nasaweather")
mutate(storms, pressure_Pa = 100 * pressure)
storms <- as_data_frame(storms)
storms
storms
x <- 10
x <- sqrt(x)
x <- round(x, 2)
x
x <- 10 %>% sqrt() %>% round(2)
x
storms %>%
filter(type == "Hurricane", year >= 1997) %>%
select(name, year, pressure) %>%
mutate(pressure_Pa = 100 * pressure)
storms %>%
group_by(year, month) %>%
summarise(min_speed = min(wind), max_speed = max(wind))
100000
storms %>%
group_by(month) %>%
summarise(min_speed = min(wind), max_speed = max(wind))
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"),
samp_size, replace = TRUE, prob = c(4,6))
mns <- c(Purple = 760, Green = 700)[plant_morphs]
sds <- c(Purple = 160, Green = 150)[plant_morphs]
morph.data <- data.frame(Colour = plant_morphs,
Weight = rnorm(samp_size, mns, sds))
write.csv(morph.weights, row.names = FALSE,
file = "./data_csv/MORPH_DATA.CSV")
set.seed(27081975)
samp_size <- 250
plant_morphs <- sample(c("Purple","Green"),
samp_size, replace = TRUE, prob = c(4,6))
mns <- c(Purple = 760, Green = 700)[plant_morphs]
sds <- c(Purple = 160, Green = 150)[plant_morphs]
morph.data <- data.frame(Colour = plant_morphs,
Weight = rnorm(samp_size, mns, sds))
write.csv(morph.data, row.names = FALSE,
file = "./data_csv/MORPH_DATA.CSV")
load(file = "./_rda_objects/plant_morphs.rda")
load(file = "./_rda_objects/plant_morphs.rda")
plant_morphs
